# D1 Manager v2.2.0 Release Notes

**Release Date:** January 7, 2026  
**Status:** Stable  
**Type:** Feature Release

---

## üöÄ Overview

Version 2.2.0 introduces **Portable Export Formats** supporting SQL, JSON, and CSV/ZIP exports with complete schema information, **External Import Support** for importing from these formats, and **Batch Export Format Selection** for bulk downloads. This release also includes security updates, dependency maintenance, and CI/CD improvements.

---

## ‚ú® Features

### üì§ Portable Export Formats

Export databases in multiple formats with complete schema information for database reconstruction:

- **SQL Format**: Full database dump with schema and data (standard .sql file)
- **JSON Format**: Portable JSON with metadata and table data as arrays of objects
- **CSV Format**: ZIP archive containing `_metadata.json` + per-table CSV files with column types
- **Empty Table Support**: Tables with 0 rows export metadata only
- **Schema Preservation**: All formats include schema information for complete reconstruction

### üì• External Import Support

Import databases from SQL, JSON, or CSV/ZIP sources:

- **Flexible Target**: Create new database or import into existing database
- **Schema Inference**: Automatic schema detection from JSON/CSV metadata
- **Table Preview**: View row counts per table before import
- **Empty Table Support**: Creates schema for tables with no data rows
- **Improved Errors**: Better error messages for "database already exists" and common issues

### üìä Batch Export Format Selection

Choose export format when bulk downloading databases:

- **Format Dropdown**: Appears when databases are selected
- **Progress Indicator**: Shows current database name, completed count, and progress bar
- **Rate Limiting**: 300ms delay between databases prevents API throttling

---

## üîß Technical Improvements

### Performance

- **Export Rate Limiting**: Increased inter-table delay from 100ms to 300ms with exponential backoff retry (2s‚Üí4s‚Üí8s) for 429 errors
- **Import Cache Refresh**: Database list automatically refreshes after successful import (no page reload needed)

### Developer Experience

- **Auto-detect Local vs Production**: Environment configuration simplified with `.env.development` auto-loaded by Vite during `npm run dev`. No more manually commenting/uncommenting `.env` to switch between dev and prod

### Security

- **Fixed** CodeQL alert for incomplete string escaping in AI Search markdown export - Now escapes backslashes before pipes to prevent escaping bypass
- **Upgraded** Node.js from 20-alpine to 22-alpine (Node 20 EOL April 2026)
- **Documented** CVE-2025-60876 (busybox wget) - Not exploitable (D1 Manager uses curl); awaiting Alpine patch

### CI/CD

- **Fixed** Docker gating to properly block on CodeQL security alerts - Added `fail-on: error` to CodeQL analyze step

### Dependencies

- **wrangler**: Downgraded 4.56.0 ‚Üí 4.54.0 (4.56.0 deprecated due to AI module peer dependency bug and R2 Data Catalog issues)
- **vite**: Updated 7.3.0 ‚Üí 7.3.1

---

## üì¶ Upgrade Instructions

1. **Pull the latest changes**:

   ```bash
   git pull origin main
   ```

2. **Update dependencies**:

   ```bash
   npm install
   ```

3. **Deploy the Worker**:
   ```bash
   npm run build
   npx wrangler deploy
   ```

---

## üìö Documentation

- **[Changelog](https://github.com/neverinfamous/d1-manager/wiki/Changelog)** ‚Äî Detailed list of changes
- **[Wiki](https://github.com/neverinfamous/d1-manager/wiki)** ‚Äî Complete documentation
- **[Database Management](https://github.com/neverinfamous/d1-manager/wiki/Database-Management)** ‚Äî Export and import guides
- **[Bulk Operations](https://github.com/neverinfamous/d1-manager/wiki/Bulk-Operations)** ‚Äî Batch export documentation

---

**Made with ‚ù§Ô∏è for the Cloudflare community**
