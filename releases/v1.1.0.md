# D1 Manager v1.1.0 Release Notes

**Release Date:** November 27, 2025  
**Status:** Production/Stable  
**Type:** Major Feature Release

---

## üöÄ Overview

This release introduces three major features (Read Replication, Time Travel, Job History), along with comprehensive TypeScript strict mode compliance fixing 100+ type issues across the codebase.

---

## ‚ú® Major Features

### Read Replication

- **Replication Status Display** - View read replication status for each database (globe badge in database list)
- **Enable/Disable Control** - Toggle read replication via dedicated Replication tab in database view
- **Query Serving Info** - See which region served your queries in Query Console
- **Sessions API Education** - Educational content about using Sessions API in your applications
- **New API Endpoint** - PUT `/api/databases/:dbId/replication` to control read replication mode

### Time Travel

- **Current Bookmark Display** - View the current database bookmark (point-in-time state)
- **CLI Restore Commands** - Copy-ready Wrangler CLI commands for point-in-time recovery
- **Checkpoint History** - View saved checkpoints captured before destructive operations
- **Manual Checkpoints** - Create manual checkpoint snapshots at any time
- **Automatic Capture** - Bookmarks automatically captured before DROP TABLE, DROP COLUMN, and DELETE operations
- **Retention Info** - Clear display of Time Travel retention periods (30 days Paid / 7 days Free)
- **Dedicated Tab** - New "Time Travel" tab in database view

### Job History

- **Operation Tracking** - Comprehensive tracking of bulk operations (export, import, delete, rename, optimize)
- **Job List View** - View all jobs with status badges, progress, error counts, and timestamps
- **Advanced Filtering** - Filter by status, operation type, database, date range, job ID, and minimum errors
- **Sorting Options** - Sort by started time, completed time, total items, or error count
- **Event Timeline** - Detailed event timeline for each job showing progress milestones and errors
- **Job Details Dialog** - Click any job to view full event history with timestamps
- **Database Schema** - New `bulk_jobs` and `job_audit_events` tables for persistent storage

### Cascade Impact Simulator

- **Interactive Graph Visualization** - ReactFlow-powered dependency graph with color-coded nodes
  - üî¥ Red nodes for source tables/rows being deleted
  - üü° Yellow nodes for CASCADE operations
  - üîµ Blue nodes for SET NULL operations
  - ‚ö™ Gray nodes for RESTRICT/NO ACTION
- **Theoretical Simulation** - Non-destructive analysis with recursive traversal
- **Detailed Impact Analysis** - Total affected rows, maximum cascade depth, table-by-table breakdown
- **Multi-Format Export** - CSV, JSON, Text, and PDF reports

### Undo/Rollback System

- **10-Operation History** - Keeps last 10 destructive operations per database
- **Automatic Snapshots** - Captures full table schemas, indexes, and data before DROP operations
- **Per-Database Storage** - Undo history stored in metadata database with proper indexing
- **Global Undo Button** - Header badge showing available undo operation count

### Foreign Key Visualizer/Editor

- **Dual Layout System** - Switch between hierarchical (dagre) and force-directed graph layouts
- **Interactive Graph** - ReactFlow-powered visualization with pan, zoom, and minimap
- **Add Foreign Keys** - Create new foreign key constraints with comprehensive validation
- **Modify Constraints** - Edit ON DELETE and ON UPDATE behaviors
- **Delete Constraints** - Remove foreign key relationships with impact preview
- **Type Validation** - Automatic column type compatibility checking
- **Orphan Detection** - Prevents adding FKs that would violate referential integrity
- **Color-Coded Edges** - Visual distinction between CASCADE, RESTRICT, SET NULL, NO ACTION

### FTS5 Virtual Table Management

- **Visual Schema Designer** - Create FTS5 full-text search tables with interactive column builder
- **Table Converter** - Convert existing tables to FTS5 with external content support
- **Multiple Tokenizers** - Unicode61, Porter (stemming), Trigram (fuzzy search), ASCII
- **Advanced Configuration** - Diacritic handling, custom separators, token characters
- **Prefix Indexing** - Enable autocomplete with configurable prefix lengths
- **Dedicated Search Interface** - Advanced search UI with BM25 ranking

### Additional Features

- **Constraint Validator** - Validate FK, NOT NULL, and UNIQUE constraints across database
- **Index Analyzer** - Schema analysis with one-click index creation
- **Circular Dependency Detector** - DFS-based cycle detection with severity classification
- **ER Relationship Diagram** - Visual schema display with multi-format export
- **Advanced Row Filters** - OR logic, BETWEEN, IN operators, filter presets
- **Foreign Key Navigation** - Clickable FK values with breadcrumb trail

---

## üõ°Ô∏è Code Quality

### TypeScript Strict Mode

- **Maximum Strictness Achieved** - Full codebase passes the most aggressive TypeScript and ESLint strict settings
- **`exactOptionalPropertyTypes: true`** - Prevents `undefined` from being assigned to optional properties
- **`noUncheckedIndexedAccess: true`** - Array and object index access now returns `T | undefined`
- **100+ Errors Fixed** - Comprehensive type safety improvements across frontend and worker

---

## üîß API Enhancements

### New Endpoints

- `GET /api/jobs` - List jobs with filtering
- `GET /api/jobs/:jobId` - Get single job status
- `GET /api/jobs/:jobId/events` - Get job event timeline
- `GET /api/tables/:dbId/foreign-keys` - Get all foreign keys with graph structure
- `POST /api/tables/:dbId/foreign-keys/add` - Add new foreign key constraint
- `PATCH /api/tables/:dbId/foreign-keys/:constraintName` - Modify FK behaviors
- `DELETE /api/tables/:dbId/foreign-keys/:constraintName` - Remove FK constraint
- `GET /api/indexes/:dbId/analyze` - Analyze database and return index recommendations
- `POST /api/undo/:dbId/list` - List available undo operations
- `POST /api/undo/:dbId/restore/:operationId` - Restore a previous operation
- `GET /api/time-travel/:dbId/bookmark` - Get current database bookmark
- `GET /api/time-travel/:dbId/history` - Get stored checkpoint history
- `POST /api/time-travel/:dbId/capture` - Manually capture a checkpoint
- `DELETE /api/time-travel/:dbId/history/:id` - Delete a checkpoint entry
- `PUT /api/databases/:dbId/replication` - Enable/disable read replication

---

## üì¶ Upgrade Instructions

1. **Pull the latest changes**:

   ```bash
   git pull origin main
   npm install
   ```

2. **Apply migration**:

   ```bash
   npx wrangler d1 execute d1-manager-metadata --remote --file=worker/migrations/001_add_job_history.sql
   ```

3. **Deploy**:
   ```bash
   npm run build
   npx wrangler deploy
   ```

---

## üìö Documentation

- **[Changelog](https://github.com/neverinfamous/d1-manager/wiki/Changelog)** ‚Äî Detailed list of changes
- **[Wiki](https://github.com/neverinfamous/d1-manager/wiki)** ‚Äî Updated guides for new features

---

**Made with ‚ù§Ô∏è for the Cloudflare community**
